# FireEye Flare-On 2014

## Challenge 1

We are given a .NET executable. Opening it in dnSpy reveals the following
code for a decode function:

```
private void btnDecode_Click(object sender, EventArgs e)
{
    this.pbRoge.Image = Resources.bob_roge;
    byte[] dat_secret = Resources.dat_secret;
    string text = "";
    foreach (byte b in dat_secret)
    {
        text += (char)((b >> 4 | ((int)b << 4 & 240)) ^ 41);
    }
    text += "\0";
    string text2 = "";
    for (int j = 0; j < text.Length; j += 2)
    {
        text2 += text[j + 1];
        text2 += text[j];
    }
    string text3 = "";
    for (int k = 0; k < text2.Length; k++)
    {
        char c = text2[k];
        text3 += (char)((byte)text2[k] ^ 102);
    }
    this.lbl_title.Text = text3;
}
```

After saving the `dat_secret` file from the resouces in the executable, we
can run the following re-implementation of the decryption function in
python:

```
f = open('dat_secret', 'rb')
x = f.read()

y = ''
for i in x:
    y += chr(((i>>4) | ((i<<4) & 240)) ^ 41)

y += '\0'
print(y)

z = ''
for i in range(0,16,2):
    z += y[i+i]
    z += y[i]
print(z)

w = ''
for i in z:
    w += chr(ord(i)^102)
print(w)
```

It took me a while to find the flag, since I was only looking at the final
output of the decryption. As output to the first step of the decryption, we
get the flag: `3rmahg3rd.b0b.d0ge@flare-on.com`

